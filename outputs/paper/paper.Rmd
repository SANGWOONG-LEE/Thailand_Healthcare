---
title: "The serious gap laying on healthcare system in Thailand^[Code and data are available at: https://github.com/SANGWOONG-LEE/Thailand_Healthcare]"
subtitle: "Why there exists gap between health system and mother's report for immunization"
author: 
  - SangWoong Lee
  - Young Suk
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "This paper has been examined possible variables that influenced children immunization report cases between healthcare system and mother's reports in Thailand. We have found that there existed significantly different rate regarding communities, region, education level and religion. This is important in a sense that it relates to lives as well as indication for why such gap exited. We will discuss its importance in details later in discussion session."
output:
  bookdown::pdf_document2:
    fig_caption: yes
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
library(tidyverse)
library(dplyr)
library(knitr)
```

# Introduction
Trust is a big matter in this world. Especially when you need assistance in fields that you are unfamiliar with, trust is the best thing that you can rely on. For instance, if you need a lawyer, the best thing that you can do is to trust your lawyer, and be 100% honest. In medical field, trust is directly related to your life. We are certain that you have observed that many people have been refusing to get COVID-19 vaccines. Then, we started to wonder whether the COVID-19 vaccine controversy is similar to other vaccines that safety are proved and guaranteed such as BCG vaccine for preventing tuberculosis. It is true that we no longer have doubts against them. However, if you move sight to developing country in 1980~1990s, situation would certainly different because of lack of well constructed healthcare system or other reasons. This curiosity triggered us to start this research. 

This paper is about children immunization reports in 1987, Thailand. Specifically how the rate differs between communities, regions, people with different education levels and religion. Along with that, its cases are divided into reports from mothers and healthcare. There clearly exists limitations and gaps that we are required to fill. First, gap between present and past. We cannot go back to the period and conduct research regarding our focus. Second, thoughts cannot be measured thoroughly. To overcome the limitations, we tried to look for powerful candidates. Among many, we thought that 1987 DHS survey in Thailand specifically regarding children immunization rate from healthcare and mothers with respect to their features would be the best one to represent our interest.

Dataset was not open. Instead, the survey presented various tables. Thus, we were required to convert pdf file to csv. After that throughout the analysis of relation between the variables and immunization rate reported by healthcare and mothers, we could observe that there existed significant gap between healthcare and mothers with respect to variables. This is an important finding because it shows that there could be lack of trust toward healthcare system or shortage of healthcare supports in Thailand. Thus, it can indicate where or who to focus for the healthcare system to gain trust. With further research, we will be able observe how it has been improved since 1987, but for now we are going to focus on why the gap existed in 1987, Thailand. For detailed answer for why will be discussed in discussion session. 

For this paper, after this introduction session, you are going to explore

2) Data
3) Results
4) Discussion
5) Reference list


# Data
To obtain data with respect to our interest, we took an approach to Thailand DHS survey in 1980s and 1990s. Among many candidates, we chose year 1987. In the survey, there existed many similar data regarding our aim. For instance, a data presented child and infant mortality with respect to participants' features. It showed the mortality rate with same variables that our data has. However, we thought that mortality alone could not be enough to show why the gap existed between healthcare system and mothers. Following that, we made a decision that combining other variables would cause bias in this research. 
The data we chose presented cases of children immunization status between communities(urban and rural), region(north,northeast,central,south and Bangkok), education level(no education, primary, secondary and higher), religion: (Buddhist and Islam), and where they were reported, or whether  children did not get one or not. For a small drawback, other religions such as Christianity was excluded since majority of Thai believe in Buddhism and rest believe in Islam.  
Now let's begin to talk about our data in details.

1) Communities
- Urban
- Rural

Surprisingly, in 1987 Thailand, if you take a look at figure\@ref(fig:fig1) and \@ref(fig:fig2), there were more people in rural than urban areas. According to Statistic, urbanization rate in Thailand from 2010 to 2020  slowly increased but it still remained mid 40 percentage to 50 percentage. This is very small compared to that of US, which is mid 70 to 80. In addition to the population density between urban and rural, mother's report cases were more than healthcare in rural area. Calculating the percentage, it was 60% vs 22.8%. On the other hand, there seems comparatively similar cases between healthcare and mothers in urban areas. Lastly,immunization rate is higher in urban compared to rural areas. 

2) Region
- North
- Northeast
- Central
- South
- Bangkok

Figure\@ref(fig:fig3) shows regional based immunization status. Most participants were not from Bangkok, the capital of Thailand. Instead, they were from Northeast. This is because Islan, the northeast part of Thailand, is the largest region of Thailand, and urbanization in Thailand is relatively low. The graph shows very similar trends with \@ref(fig:fig1). There were more mother's reports outside of Bangkok, and less immunization rate outside of Bangkok. On the other hand, comparatively equal cases are observed in Bangkok. One thing to notice is that percentage of mother's reports in Northeast is noticeably higher. 

3) Education level
- No Education
- Primary
- Secondary
- Higher 

If you look at figure\@ref(fig:fig4), you can observe that as education level goes up, gap between mother's report and healthcare is being filled. In addition to that, non immunization rate decreases. One thing to notice is that higher education you have in Thailand, there existed more immunization rate. For instance, people with higher education shows immunization rate close to 100%.  

4) Religion
- Buddhist
- Islam 

At the beginning of introduction, we talked about small drawback in religion, which is other religions except Buddhisms and Islam were not collected. Moreover, majority of Thai people believes in Buddhism \@ref(fig:fig1), thus in the graph figure\@ref(fig:fig5), you can observe that there existed more cases in Buddhism than Islam. As we have observed up to this point, similar to other variables, there existed more mother's report cases than that of healthcare with no exception to religion. 

```{r, include=FALSE, echo=FALSE}
# Read the extracted and cleaned data, data extraction done in 01-gather-data.R and modification done in 02-clean-and-prepare-data.R
data <- read_csv("outputs/data/cleaned_data.csv")

urban_rural <- pivot_longer(data[1:2, 1:5], -c(Variable, Received_Immunization), names_to="immune_status", values_to="value")
region <- pivot_longer(data[3:7, 1:5], -c(Variable, Received_Immunization), names_to="immune_status", values_to="value")
education <- pivot_longer(data[8:11, 1:5], -c(Variable, Received_Immunization), names_to="immune_status", values_to="value")
religion <- pivot_longer(data[12:13, 1:5], -c(Variable, Received_Immunization), names_to="immune_status", values_to="value")
total <- pivot_longer(data[14, 1:5], -c(Variable, Received_Immunization), names_to="immune_status", values_to="value")
population <- data.frame(Variable = data$Variable, 
                         Population = data$Number_of_Children) %>% head(-1)
population$Variable <- factor(population$Variable,
                              levels = population$Variable) %>% fct_rev()
```

```{r}

# create new dataset only for urban-rural data
# urban_rural <- data.frame(location = c(rep("urban", data[1,6]), rep("rural", data[2,6])),
#                 immune_data =  c(rep("Health Report", round(data[1,2]*data[1,6]/100)), rep("Mothers Report", round(data[1,3]*data[1,6]/100)), rep("No immune", round(data[1,5]*data[1,6]/100)), 
#                                  rep("Health Report", round(data[2,2]*data[2,6]/100)), rep("Mothers Report", round(data[2,3]*data[2,6]/100)), rep("No immune", round(data[2,5]*data[2,6]/100)))
#                 
#                 )

# create new dataset only for for region
# region <- data.frame(region = c(rep("north", data[3,6]), rep("north_east", data[4,6]), rep("central", data[5,6]), rep("south", data[6,6]), rep("bangkok", data[7,6])),
#                     immune_data =  c(rep("Health Report", round(data[3,2]*data[3,6]/100)), rep("Mothers Report", round(data[3,3]*data[3,6]/100)), rep("No immune", round(data[3,5]*data[3,6]/100)), 
#                                  rep("Health Report", round(data[4,2]*data[4,6]/100)), rep("Mothers Report", round(data[4,3]*data[4,6]/100)), rep("No immune", round(data[4,5]*data[4,6]/100)),
#                                  rep("Health Report", round(data[5,2]*data[5,6]/100)), rep("Mothers Report", round(data[5,3]*data[5,6]/100)), rep("No immune", round(data[5,5]*data[5,6]/100)), 
#                                  rep("Health Report", round(data[6,2]*data[6,6]/100)), rep("Mothers Report", round(data[6,3]*data[6,6]/100)), rep("No immune", round(data[6,5]*data[6,6]/100)),
#                                  rep("Health Report", round(data[7,2]*data[7,6]/100)), rep("Mothers Report", round(data[7,3]*data[7,6]/100)), rep("No immune", round(data[7,5]*data[7,6]/100)))
#                     )

# create new dataset only for for education. due to an error in the dataset provided by DHS, some rows will be filled with NA.

 # no_edu <-data.frame(education = c(rep("no_edu", 265)),
 #                     immune_data = c(rep("Health Report", round(data[8,2]*data[8,6]/100)), rep("Mothers Report", round(data[8,3]*data[8,6]/100)), rep("No immune", round(data[8,5]*data[8,6]/100)))
 #                     )
 # 
 # primary <-data.frame(education = c(rep("primary", data[9,6])),
 #                     immune_data = c(rep("Health Report", round(data[9,2]*data[9,6]/100)), rep("Mothers Report", floor(data[9,3]*data[9,6]/100)), rep("No immune", round(data[9,5]*data[9,6]/100)))
 #                     )
 # 
 # secondary <-data.frame(education = c(rep("secondary", data[10,6])),
 #                     immune_data = c(rep("Health Report", floor(data[10,2]*data[10,6]/100)), rep("Mothers Report", floor(data[10,3]*data[10,6]/100)), rep("No immune", round(data[10,5]*data[10,6]/100)))
 #                    )
# education <- data.frame(education = c(rep("no_education", round(data[8,2]*data[8,6]/100) + round(data[8,3]*data[8,6]/100) + round(data[8,5]*data[8,6]/100)), 
#                                       rep("primary", round(data[9,2]*data[9,6]/100) + round(data[9,3]*data[9,6]/100) + round(data[9,5]*data[9,6]/100)), 
#                                       rep("secondary", round(data[10,2]*data[10,6]/100) + round(data[10,3]*data[10,6]/100) + round(data[10,5]*data[10,6]/100)),
#                                       rep("higher", round(data[11,2]*data[11,6]/100) + round(data[11,3]*data[11,6]/100) + round(data[11,5]*data[11,6]/100))),
#                     immune_data =  c(rep("Health Report", round(data[8,2]*data[8,6]/100)), rep("Mothers Report", round(data[8,3]*data[8,6]/100)), rep("No immune", round(data[8,5]*data[8,6]/100)),
#                                  rep("Health Report", round(data[9,2]*data[9,6]/100)), rep("Mothers Report", round(data[9,3]*data[9,6]/100)), rep("No immune", round(data[9,5]*data[9,6]/100)),
#                                  rep("Health Report", round(data[10,2]*data[10,6]/100)), rep("Mothers Report", round(data[10,3]*data[10,6]/100)), rep("No immune", round(data[10,5]*data[10,6]/100)),
#                                  rep("Health Report", round(data[11,2]*data[11,6]/100)), rep("Mothers Report", round(data[11,3]*data[11,6]/100)), rep("No immune", round(data[11,5]*data[11,6]/100)))
#                     )

# create new dataset only for for education
# religion <- data.frame(religion = c(rep("Buddhist", data[12,6]), rep("Islam", data[13,6])),
#                 immune_data =  c(rep("Health Report", round(data[12,2]*data[12,6]/100)), rep("Mothers Report", round(data[12,3]*data[12,6]/100)), rep("No immune", round(data[12,5]*data[12,6]/100)), 
#                                  rep("Health Report", round(data[13,2]*data[13,6]/100)), rep("Mothers Report", round(data[13,3]*data[13,6]/100)), rep("No immune", round(data[13,5]*data[13,6]/100)))
#                       )
# 
# total <- data.frame(total = c(rep("total", data[14,6])),
#                 immune_data =  c(rep("Health Report", floor(data[14,2]*data[14,6]/100)), rep("Mothers Report", floor(data[14,3]*data[14,6]/100)), rep("No immune", floor(data[14,5]*data[14,6]/100)))
#                       )
```

```{r fig1,echo=FALSE, fig.cap = "Immunization cases between variables"}
population %>%
  ggplot(aes(x = Variable, y = Population, fill = Variable)) +
  geom_bar(stat='identity', position = "dodge") +
  coord_flip()
```

```{r fig2,echo=FALSE, fig.cap = "Immunization cases between communities"}
#ggplot(data[1:2,], aes(x = Variable, y = Health_Record)) + geom_bar(stat='identity') + facet_wrap(~Mothers_Report)
urban_rural %>%
  ggplot(aes(x = immune_status, y = value, fill = Variable)) +
  geom_bar(stat='identity', position = "dodge") +
  coord_flip()
```

```{r fig3,echo=FALSE, fig.cap = "Immunization cases between region"}
#ggplot(data[3:7,], aes(x = Variable, y = Health_Record, fill = Variable)) + geom_bar(stat='identity')
region %>%
  ggplot(aes(x = Variable, y = value, fill = immune_status)) +
  geom_bar(stat='identity', position = "dodge") +
  coord_flip()
```
```{r fig4,echo=FALSE, fig.cap = "Immunization cases between education"}
#ggplot(data[8:11,], aes(x = Variable, y = Health_Record, fill = Variable)) + geom_bar(stat='identity')
education %>%
  ggplot(aes(x = Variable, y = value, fill = immune_status)) +
  geom_bar(stat='identity', position = "dodge") +
  coord_flip()
```

```{r fig5,echo=FALSE, fig.cap = "Immunization cases between religion"}
#ggplot(data[12:13,], aes(x = Variable, y = Health_Record, fill = Variable)) + geom_bar(stat='identity')
religion %>%
  ggplot(aes(x = immune_status, y = value, fill = Variable)) +
  geom_bar(stat='identity', position = "dodge") +
  coord_flip()  +
  labs(x = element_blank(),
       y = "Percent",
       title = "Percentage of Children's Immunization Status",
       )
```

```{r fig6,echo=FALSE, fig.cap = "Immunization and non-immunization cases total"}
total %>%
  ggplot(aes(x = immune_status, y = value, fill = immune_status)) +
  geom_bar(stat='identity', position = "dodge") +
  coord_flip() +
  labs(x = element_blank(),
       y = "Percent",
       title = "Percentage of Children's Immunization Status",
       ) +
  theme(legend.position = "none")
```

# Results
Results will likely require summary statistics, tables, graphs, images, and possibly statistical analysis or maps. To be clear, you should also have text associated with all these aspects. Show the reader the results by plotting them. Talk about them. Explain them. That said, this section should strictly relay results.

In this session, we are going to explore the results of analysis. To do that, we are going to use top-down method. Let's take a look at figure\@ref(fig:fig6), which is the total result of immunization reports. This graph shows that how different immunization rate between healthcare and mother reports are with non immunization rate among 2872 participants. 

# Discussion

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References
https://www.statista.com/statistics/455942/urbanization-in-thailand/
https://www.statista.com/statistics/269967/urbanization-in-the-united-states/

